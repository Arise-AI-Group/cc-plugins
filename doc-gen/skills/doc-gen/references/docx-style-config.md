# DOCX Style Configuration Reference

Style configurations define colors, fonts, spacing, and element-specific formatting for DOCX documents generated by `docx_builder`.

## Quick Start

```bash
# Create document with brand
./run tool/docx_builder/cli.py create doc.docx --brand mybrand

# Add styled content
./run tool/docx_builder/cli.py add-heading doc.docx "Title" --level 1
./run tool/docx_builder/cli.py add-paragraph doc.docx "Body text here"
```

## Built-in Styles

| Style | Description |
|-------|-------------|
| `default` | Clean, minimal styling |
| `professional` | Business documents with blue headers |
| `proposal` | Quote/proposal with accent highlights |
| `40hero` | 4.0 Hero Industrial branding |

Styles are stored in `styles/*.json`. User brands are stored in `~/.config/doc-gen/brands/`.

---

## Configuration Schema

### Top-Level Structure

```json
{
  "$schema": "docx-style-config-v1",
  "metadata": { ... },
  "page": { ... },
  "colors": { ... },
  "fonts": { ... },
  "styles": { ... },
  "tables": { ... },
  "lists": { ... },
  "contact": { ... }
}
```

---

## Sections

### `metadata`

Optional metadata about the style.

```json
"metadata": {
  "name": "My Style",
  "description": "Custom company branding"
}
```

---

### `page`

Page setup configuration.

```json
"page": {
  "size": "letter",
  "margins": {
    "top": "0.75in",
    "bottom": "1in",
    "left": "0.75in",
    "right": "0.75in"
  }
}
```

| Property | Values |
|----------|--------|
| `size` | `letter`, `a4` |
| `margins` | Inch values as strings (e.g., `"1in"`) |

---

### `colors`

Named color palette. Use these names throughout the config.

```json
"colors": {
  "primary": "#2C4A6E",
  "accent": "#E07A38",
  "text": "#333333",
  "muted": "#666666",
  "light": "#F8F9FA",
  "success": "#27AE60",
  "warning": "#E67E22",
  "danger": "#C0392B",
  "border": "#E0E0E0"
}
```

Reference colors by name in other sections:
```json
"font": { "color": "primary" }
```

---

### `fonts`

Font family definitions for different contexts.

```json
"fonts": {
  "heading": { "name": "Arial", "bold": true },
  "body": { "name": "Arial", "size": 10.5 },
  "mono": { "name": "Courier New", "size": 9 }
}
```

---

### `styles`

Element-specific formatting for headings, body, bullets, etc.

```json
"styles": {
  "title": {
    "font": { "name": "Arial", "size": 24, "bold": true, "color": "primary" },
    "alignment": "center",
    "spacing": { "after": 6 }
  },
  "heading1": {
    "font": { "name": "Arial", "size": 14, "bold": true, "color": "primary", "allCaps": true },
    "spacing": { "before": 18, "after": 10 }
  },
  "heading2": { ... },
  "heading3": { ... },
  "body": {
    "font": { "name": "Arial", "size": 11, "color": "text" },
    "spacing": { "after": 8 }
  },
  "bullet": {
    "font": { "name": "Arial", "size": 11, "color": "text" },
    "spacing": { "after": 4 }
  }
}
```

#### Font Properties

| Property | Type | Description |
|----------|------|-------------|
| `name` | string | Font family |
| `size` | number | Size in points |
| `bold` | boolean | Bold text |
| `italic` | boolean | Italic text |
| `underline` | boolean | Underlined |
| `color` | string | Hex or named color |
| `allCaps` | boolean | All uppercase |

#### Paragraph Properties

| Property | Type | Description |
|----------|------|-------------|
| `alignment` | string | `left`, `center`, `right`, `justify` |
| `spacing.before` | number | Space before (points) |
| `spacing.after` | number | Space after (points) |
| `indent.left` | string/number | Left indent |

---

### `tables`

Table styling definitions.

```json
"tables": {
  "default": {
    "headerRow": {
      "background": "primary",
      "font": { "color": "#FFFFFF", "bold": true, "size": 10 }
    },
    "bodyRow": {
      "font": { "size": 10 }
    }
  },
  "investment": {
    "headerRow": { ... },
    "bodyRow": { ... },
    "totalRow": {
      "background": "light",
      "font": { "bold": true, "color": "primary" }
    }
  }
}
```

---

### `lists`

List marker styling.

```json
"lists": {
  "bullet": { "symbol": "•", "color": "text" },
  "check": { "symbol": "✓", "color": "success" },
  "cross": { "symbol": "✗", "color": "danger" },
  "dash": { "symbol": "—", "color": "text" }
}
```

---

### `contact`

Contact information for branded documents.

```json
"contact": {
  "company": "Company Name",
  "tagline": "Company Tagline",
  "email": "contact@example.com"
}
```

---

## Element Mapping

| docx_builder Command | Style Used |
|---------------------|------------|
| `add-heading --level 1` | `title` |
| `add-heading --level 2` | `heading1` |
| `add-heading --level 3` | `heading2` |
| `add-paragraph` | `body` |
| `add-bullet-list` | `bullet` + `lists.{style}` |
| `add-numbered-list` | `bullet` |
| `add-table` | `tables.{style}` |

---

## Creating Custom Brands

1. **Create a brand from a reference DOCX:**
   ```bash
   ./run tool/brand_manager.py create mybrand --from-docx reference.docx
   ```

2. **Or create manually and modify colors:**
   ```bash
   ./run tool/brand_manager.py create mybrand
   # Edit ~/.config/doc-gen/brands/mybrand/brand.json
   ```
   ```json
   "colors": {
     "primary": "#YOUR_BRAND_COLOR",
     "accent": "#YOUR_ACCENT"
   }
   ```

3. **Use your brand:**
   ```bash
   ./run tool/docx_builder/cli.py create doc.docx --brand mybrand
   ```

4. **Set as default:**
   ```bash
   ./run tool/brand_manager.py set-default mybrand
   ```

---

## Python API

```python
from tool.styling import load_style, StyleResolver

# Load style
config = load_style("professional")

# Create resolver
resolver = StyleResolver(config)

# Get colors
primary = resolver.resolve_color("primary")

# Get element style
heading_style = resolver.get_element_style("heading1")

# Get font config
body_font = resolver.get_body_font()
```
